---
import Skeleton from "./Skeleton.astro";

export interface Props {
	content: {
		title: string;
		description?: string;
		pubDate: string;
		updatedDate?: string;
		heroImage?: string;
		schema?: string;
		tags?: string[];
	};
}

function formatDate(dateString: string): string {
	return new Date(dateString).toLocaleDateString("en-us", {
		year: "numeric",
		month: "short",
		day: "numeric",
		hour: "numeric",
		minute: "2-digit",
		timeZoneName: "short",
	});
}

const {
	content: {
		title,
		description,
		pubDate,
		updatedDate,
		heroImage,
		schema = "https://schema.org/BlogPosting",
	},
} = Astro.props;

const skeletonContent = {
	title: title,
	description: description,
	image: heroImage
}
---

<Skeleton content={skeletonContent}>
	<slot name="head" slot="head" />
	<slot name="nav" slot="nav" />
	<article class="h-entry" itemscope itemtype={schema}>
		<header>
			{heroImage && <img width={720} height={360} src={heroImage} alt="" />}
			<h1 class="title p-name" itemprop="headline">{title}</h1>
			{description && <div class="p-summary description" itemprop="abstract">{description}</div>}
		</header>
		<div class="e-content" itemprop="articleBody">
			<slot />
		</div>
		<footer>
			<hr />
			<div>
				Published on{" "}
				<time class="dt-published" itemprop="datePublished" datetime={pubDate}>
					{formatDate(pubDate)}
				</time>
			</div>
			{
				updatedDate && (
					<div>
						Last updated on{" "}
						<time
							class="dt-updated"
							itemprop="dateModified"
							datetime={updatedDate}
						>
							{formatDate(updatedDate)}
						</time>
					</div>
				)
			}
		</footer>
	</article>
</Skeleton>
